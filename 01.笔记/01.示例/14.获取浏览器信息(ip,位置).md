---
title: 获取浏览器信息
date: 2025-08-25 22:33:00
permalink: /notes/browser-info
description: 获取浏览器信息
categories:
  - 笔记
  - 时钟
tags:
  - JS
  - 浏览器信息
---

## 功能特性

- 🌐 **浏览器信息检测**：获取浏览器类型、版本、操作系统等信息
- 🌍 **IP 地址获取**：支持获取本地 IP 和公网 IP 地址
- 📍 **地理位置定位**：基于 IP 地址获取用户地理位置信息
- 💾 **智能缓存**：位置信息自动缓存 1 小时，减少 API 请求
- 🔄 **手动刷新**：支持手动刷新 IP 和位置信息
- 🎨 **美观界面**：使用 Tailwind CSS 构建的现代化界面

## 组件结构

```
Browser/
├── hooks/
│   ├── useBrowserInfo.ts    # 浏览器信息Hook
│   ├── useIPAddress.ts      # IP地址获取Hook
│   ├── useLocation.ts       # 位置信息Hook
│   └── index.ts            # 统一导出
├── index.tsx               # 主要演示组件
└── README.md              # 说明文档
```

## 使用方法

### 1. 完整演示组件

```tsx
import BrowserInfoDemo from './Browser';

function App() {
	return <BrowserInfoDemo />;
}
```

### 2. 单独使用 Hooks

```tsx
import { useBrowserInfo, useIPAddress, useLocation } from './Browser/hooks';

function MyComponent() {
	const { browserInfo, loading: browserLoading } = useBrowserInfo();
	const { ipInfo, loading: ipLoading, refresh: refreshIP } = useIPAddress();
	const { locationInfo, loading: locationLoading, refresh: refreshLocation } = useLocation();

	return (
		<div>
			<h2>浏览器: {browserInfo?.browserName}</h2>
			<h2>公网IP: {ipInfo.publicIP}</h2>
			<h2>城市: {locationInfo?.city}</h2>
		</div>
	);
}
```

## API 文档

### useBrowserInfo

获取浏览器和设备信息。

**返回值：**

```typescript
{
	browserInfo: BrowserInfo | null;
	loading: boolean;
}
```

**BrowserInfo 接口：**

```typescript
interface BrowserInfo {
	browserName: string; // 浏览器名称
	browserVersion: string; // 浏览器版本
	osName: string; // 操作系统名称
	osVersion: string; // 操作系统版本
	deviceName: string; // 设备名称（Android设备）
	userAgent: string; // 完整的User Agent字符串
}
```

### useIPAddress

获取 IP 地址信息。

**返回值：**

```typescript
{
	ipInfo: IPInfo;
	loading: boolean;
	error: string | null;
	refresh: () => Promise<void>;
}
```

**IPInfo 接口：**

```typescript
interface IPInfo {
	localIPs: string[]; // 本地IP地址列表
	publicIP?: string; // 公网IP地址
}
```

### useLocation

获取地理位置信息。

**返回值：**

```typescript
{
  locationInfo: LocationInfo | null;
  loading: boolean;
  error: string | null;
  refresh: () => Promise<void>;
  clearCache: () => void;
}
```

**LocationInfo 接口：**

```typescript
interface LocationInfo {
	ip?: string; // IP地址
	city?: string; // 城市
	region?: string; // 地区/省份
	country?: string; // 国家代码
	country_name?: string; // 国家名称
	postal?: string; // 邮政编码
	latitude?: number; // 纬度
	longitude?: number; // 经度
	timezone?: string; // 时区
	currency?: string; // 货币
	languages?: string; // 语言
	org?: string; // ISP组织
	asn?: string; // ASN号码
}
```

## 技术实现

### 浏览器信息检测

- 使用 `navigator.userAgent` 解析浏览器信息
- 支持主流浏览器：Chrome、Firefox、Safari、Edge、IE、360、QQ 浏览器
- 支持主流操作系统：Windows、macOS、iOS、Android

### IP 地址获取

- **本地 IP**：通过 WebRTC 的 ICE 候选获取
- **公网 IP**：使用多个第三方 API 服务，确保高可用性
  - ipify.org
  - ipapi.co
  - httpbin.org

### 地理位置定位

- 使用多个地理位置 API 服务
  - ipapi.co
  - ip-api.com
  - ipinfo.io
- 自动缓存机制，减少 API 调用
- 支持手动刷新和清除缓存

## 注意事项

1. **隐私保护**：所有信息仅在客户端获取，不会上传到服务器
2. **网络依赖**：IP 和位置信息需要网络连接
3. **API 限制**：第三方 API 可能有调用频率限制
4. **浏览器兼容性**：WebRTC 功能需要现代浏览器支持
5. **HTTPS 要求**：某些功能在 HTTPS 环境下工作更稳定

## 样式依赖

组件使用了 Tailwind CSS 类名，请确保项目中已安装并配置 Tailwind CSS：

```bash
npm install -D tailwindcss postcss autoprefixer
npx tailwindcss init -p
```

<demo react="react/Browser/index.tsx" 
:reactFiles="[
  'react/Browser/index.tsx',
'react/Browser/hooks/index.tsx',
'react/Browser/hooks/useBrowserInfo.tsx',
'react/Browser/hooks/useIPAddress.tsx',
'react/Browser/hooks/useLocation.tsx'
]" 
/>

<demo react="react/Browser/example.tsx" 
:reactFiles="[
  'react/Browser/example.tsx',
]" 
/>
