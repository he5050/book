---
title: Promptå˜é‡æ¨¡æ¿è¾“å…¥æ¡†
date: 2025-09-24 10:00:00
permalink: /notes/prompt-template
categories:
  - ç¬”è®°
  - ç¤ºä¾‹
tags:
  - vue
  - react
  - å¯Œæ–‡æœ¬ç¼–è¾‘å™¨
  - slate.js
  - AI
---

# Prompt å˜é‡æ¨¡æ¿è¾“å…¥æ¡†

Prompt å˜é‡æ¨¡æ¿è¾“å…¥æ¡†ï¼Œæ”¯æŒæ··åˆè¾“å…¥ï¼ˆæ–‡å­—+æ¨¡æ¿å˜é‡ï¼‰ï¼Œæ—¢ä¿ç•™äº†æ¨¡æ¿è¾“å…¥çš„ä¼˜åŠ¿ï¼Œåˆä¿æŒäº†çµæ´»çš„è‡ªç”±ç¼–è¾‘èƒ½åŠ›ã€‚

## ğŸ¯ æ•ˆæœç‰¹ç‚¹

- **æ··åˆè¾“å…¥**: æ”¯æŒæ–‡å­—ä¸æ¨¡æ¿å˜é‡æ··åˆè¾“å…¥
- **åŠ¨æ€æ¨¡æ¿**: æ”¯æŒè¾“å…¥å‹å˜é‡å’Œé€‰æ‹©å‹å˜é‡
- **å®Œæ•´å¤åˆ¶**: æ¨¡æ¿å†…å®¹å¯å®Œæ•´å¤åˆ¶ç²˜è´´
- **ç»“æ„åŒ–è¾“å‡º**: æäº¤æ—¶èƒ½ç”ŸæˆåŒ…å«ç”¨æˆ·æ‰€æœ‰é€‰æ‹©/è¾“å…¥çš„å®Œæ•´ç»“æ„åŒ–æ–‡æœ¬

## ğŸ”„ å·¥ä½œåŸç†

Prompt å˜é‡æ¨¡æ¿è¾“å…¥æ¡†çš„å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š

```mermaid
flowchart TD
    A[ç”¨æˆ·è¾“å…¥] --> B{è¾“å…¥ç±»å‹}
    B -->|æ™®é€šæ–‡å­—| C[ç›´æ¥è¾“å…¥]
    B -->|å˜é‡æ ‡ç­¾| D[åˆ›å»ºå˜é‡æ ‡ç­¾]
    D --> E{å˜é‡ç±»å‹}
    E -->|è¾“å…¥å‹| F[InputTagç»„ä»¶]
    E -->|é€‰æ‹©å‹| G[SelectTagç»„ä»¶]
    F --> H[å¯ç¼–è¾‘å†…å®¹]
    G --> I[ä¸‹æ‹‰é€‰æ‹©]
    C --> J[åºåˆ—åŒ–è¾“å‡º]
    H --> J
    I --> J
    J --> K[ç»“æ„åŒ–æ–‡æœ¬]
```

## ğŸ’» React ç‰ˆæœ¬å®ç°

### åŸºç¡€ä½¿ç”¨

<demo react="react/PromptTemplate/example.tsx" 
:reactFiles="['react/PromptTemplate/index.tsx','react/PromptTemplate/example.tsx','react/PromptTemplate/index.scss']" 
/>

**æ ¸å¿ƒåŸç†**ï¼š

- ä½¿ç”¨ slate-react åº“å®ç°å¯Œæ–‡æœ¬ç¼–è¾‘å™¨åŠŸèƒ½
- é€šè¿‡è‡ªå®šä¹‰çš„ InputTag å’Œ SelectTag ç»„ä»¶å®ç°å¯ç¼–è¾‘çš„å˜é‡æ¨¡æ¿
- åˆ©ç”¨ slate çš„ inline èŠ‚ç‚¹ç‰¹æ€§æ”¯æŒå…‰æ ‡åœ¨å˜é‡æ ‡ç­¾å†…éƒ¨å’Œå‘¨å›´æ­£ç¡®å®šä½

**å®ç°è¦ç‚¹**ï¼š

1. ä½¿ç”¨ Slate ç»„ä»¶ä½œä¸ºç¼–è¾‘å™¨å®¹å™¨
2. é€šè¿‡ renderElement å‡½æ•°å¤„ç†ä¸åŒç±»å‹çš„å…ƒç´ 
3. ä½¿ç”¨ InputTag ç»„ä»¶å®ç°å¯è¾“å…¥çš„å˜é‡æ ‡ç­¾
4. ä½¿ç”¨ SelectTag ç»„ä»¶å®ç°ä¸‹æ‹‰é€‰æ‹©çš„å˜é‡æ ‡ç­¾
5. é€šè¿‡ serializeToPlainText å‡½æ•°å°†ç¼–è¾‘å™¨å†…å®¹è½¬æ¢ä¸ºçº¯æ–‡æœ¬

### é«˜çº§ä½¿ç”¨

<demo react="react/PromptTemplate/example.tsx" 
:reactFiles="['react/PromptTemplate/index.tsx','react/PromptTemplate/example.tsx','react/PromptTemplate/index.scss']" 
/>

```jsx
import React, { useRef } from 'react';
import PromptTemplate from './PromptTemplate';

const MyComponent = () => {
	const promptTemplateRef = useRef();

	const handleGetContent = () => {
		const content = promptTemplateRef.current?.getContent();
		console.log(content);
	};

	const handleSetContent = () => {
		const template = [
			{
				type: 'paragraph',
				children: [
					{ text: 'è¯·å¸®æˆ‘å†™ä¸€ç¯‡å…³äº' },
					{ type: 'input-tag', children: [{ text: 'äººå·¥æ™ºèƒ½' }], label: '[ä¸»é¢˜]' },
					{ text: 'çš„' },
					{
						type: 'select-tag',
						children: [{ text: '' }],
						value: 'æ–‡ç« ',
						options: [
							{ label: 'æ–‡ç« ', value: 'æ–‡ç« ' },
							{ label: 'è®ºæ–‡', value: 'è®ºæ–‡' },
							{ label: 'æŠ¥å‘Š', value: 'æŠ¥å‘Š' }
						]
					},
					{ text: 'ï¼Œè¦æ±‚å­—æ•°åœ¨' },
					{ type: 'input-tag', children: [{ text: '1500' }], label: '[å­—æ•°]' },
					{ text: 'å­—å·¦å³ã€‚' }
				]
			}
		];
		promptTemplateRef.current?.setContent(template);
	};

	return (
		<div>
			<PromptTemplate ref={promptTemplateRef} />
			<button onClick={handleGetContent}>è·å–å†…å®¹</button>
			<button onClick={handleSetContent}>è®¾ç½®æ¨¡æ¿</button>
		</div>
	);
};
```

## ğŸ› ï¸ æŠ€æœ¯å¯¹æ¯”

| å®ç°æ–¹å¼             | ä¼˜ç‚¹                     | ç¼ºç‚¹               | é€‚ç”¨åœºæ™¯       |
| -------------------- | ------------------------ | ------------------ | -------------- |
| æ‰‹æ“ contenteditable | è‡ªç”±åº¦æœ€é«˜               | å‘å¤šï¼Œç»´æŠ¤æˆæœ¬é«˜   | ç‰¹æ®Šå®šåˆ¶éœ€æ±‚   |
| å¯Œæ–‡æœ¬ç¼–è¾‘å™¨         | åŠŸèƒ½å®Œå–„                 | ä½“ç§¯å¤§ï¼Œå­¦ä¹ æˆæœ¬é«˜ | å¤æ‚ç¼–è¾‘åœºæ™¯   |
| slate.js             | å¯å®šåˆ¶æ€§å¼ºï¼Œæ’ä»¶ç”Ÿæ€ä¸°å¯Œ | å­¦ä¹ æ›²çº¿é™¡å³­       | ä¸­ç­‰å¤æ‚åº¦é¡¹ç›® |

## ğŸ“š API è¯´æ˜

### Props

| å±æ€§å       | ç±»å‹   | é»˜è®¤å€¼                                          | è¯´æ˜         |
| ------------ | ------ | ----------------------------------------------- | ------------ |
| placeholder  | string | 'è¯·è¾“å…¥ Prompt æ¨¡æ¿'                            | è¾“å…¥æ¡†å ä½ç¬¦ |
| initialValue | Node[] | [{type: 'paragraph', children: [{ text: '' }]}] | åˆå§‹å€¼       |

### æ–¹æ³•

é€šè¿‡ ref å¯ä»¥è°ƒç”¨ç»„ä»¶çš„ä»¥ä¸‹æ–¹æ³•ï¼š

- `getContent()`: è·å–ç¼–è¾‘å™¨å†…å®¹ï¼ˆçº¯æ–‡æœ¬æ ¼å¼ï¼‰
- `setContent(value: Node | Node[])`: è®¾ç½®ç¼–è¾‘å™¨å†…å®¹

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æµè§ˆå™¨å…¼å®¹æ€§**: è¯¥ç»„ä»¶ä¾èµ–ç°ä»£æµè§ˆå™¨ç‰¹æ€§ï¼Œå¯¹äºè¾ƒè€çš„æµè§ˆå™¨å¯èƒ½éœ€è¦æ·»åŠ  polyfill
2. **æ€§èƒ½ä¼˜åŒ–**: ç»„ä»¶ä¼šè‡ªåŠ¨ç›‘å¬å†…å®¹åŒºåŸŸçš„é«˜åº¦å˜åŒ–å¹¶æ›´æ–°è¿‡æ¸¡æ•ˆæœ
3. **å“åº”å¼è®¾è®¡**: ç»„ä»¶é€‚é…ä¸åŒå±å¹•å°ºå¯¸ï¼Œç¡®ä¿åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šä¹Ÿèƒ½æ­£å¸¸å·¥ä½œ

### æµè§ˆå™¨å…¼å®¹æ€§

slate-react åœ¨ä»¥ä¸‹æµè§ˆå™¨ç‰ˆæœ¬ä¸­å¾—åˆ°æ”¯æŒï¼š

- Chrome 64+
- Firefox 69+
- Safari 13.1+
- Edge 79+

## ğŸ¨ è®¾è®¡å»ºè®®

### ç”¨æˆ·ä½“éªŒ

- **å…‰æ ‡å®šä½**: ç¡®ä¿å…‰æ ‡å¯ä»¥åœ¨å˜é‡æ ‡ç­¾å†…éƒ¨å’Œå‘¨å›´æ­£ç¡®å®šä½
- **å ä½ç¬¦æ˜¾ç¤º**: åœ¨å˜é‡æ ‡ç­¾æœªè¾“å…¥å†…å®¹æ—¶æ˜¾ç¤ºå ä½ç¬¦
- **äº¤äº’åé¦ˆ**: æä¾›æ˜ç¡®çš„å˜é‡æ ‡ç­¾äº¤äº’åé¦ˆ

### è§†è§‰è®¾è®¡

- **æ ‡ç­¾æ ·å¼**: ä½¿ç”¨é†’ç›®çš„é¢œè‰²åŒºåˆ†å˜é‡æ ‡ç­¾å’Œæ™®é€šæ–‡æœ¬
- **è¾¹æ¡†è®¾è®¡**: æ·»åŠ é€‚å½“çš„è¾¹æ¡†å’Œåœ†è§’æå‡è§†è§‰æ•ˆæœ
- **å­—ä½“é€‰æ‹©**: ä½¿ç”¨æ¸…æ™°æ˜“è¯»çš„å­—ä½“

### æ€§èƒ½ä¼˜åŒ–

- **é¿å…é‡æ’**: ä½¿ç”¨ `transform` è€Œéæ”¹å˜å¸ƒå±€å±æ€§
- **èŠ‚æµæ§åˆ¶**: ResizeObserver æœ¬èº«å·²ä¼˜åŒ–æ€§èƒ½ï¼Œæ— éœ€é¢å¤–èŠ‚æµ
- **å†…å­˜ç®¡ç†**: ç»„ä»¶é”€æ¯æ—¶æ­£ç¡®æ–­å¼€äº‹ä»¶ç›‘å¬å™¨è¿æ¥

## ğŸš€ è¿›é˜¶åº”ç”¨

### æ¨¡æ¿åº“

- æ”¯æŒé¢„è®¾æ¨¡æ¿åº“å¿«é€Ÿæ’å…¥
- æ”¯æŒç”¨æˆ·è‡ªå®šä¹‰æ¨¡æ¿ä¿å­˜

### åŠ¨æ€å†…å®¹

- é€‚é…åŠ¨æ€åŠ è½½çš„å†…å®¹
- æ”¯æŒå¼‚æ­¥æ•°æ®æ›´æ–°åçš„é«˜åº¦è°ƒæ•´

### ä¸»é¢˜åˆ‡æ¢

- æ”¯æŒæ˜æš—ä¸»é¢˜
- åŠ¨æ€è°ƒæ•´æ ·å¼å’ŒåŠ¨ç”»æ•ˆæœ

## ğŸ“Š æ€§èƒ½åˆ†æ

Prompt å˜é‡æ¨¡æ¿è¾“å…¥æ¡†ç»„ä»¶çš„æ€§èƒ½è¡¨ç°ï¼š

```mermaid
graph LR
    A[åˆå§‹åŒ–] --> B[åˆ›å»ºç¼–è¾‘å™¨å®ä¾‹]
    B --> C[æ¸²æŸ“åˆå§‹å†…å®¹]
    C --> D[ç›‘å¬è¾“å…¥äº‹ä»¶]
    D --> E{è¾“å…¥ç±»å‹}
    E -->|æ™®é€šæ–‡å­—| F[ç›´æ¥æ¸²æŸ“]
    E -->|å˜é‡æ ‡ç­¾| G[åˆ›å»ºæ ‡ç­¾ç»„ä»¶]
    F --> H[æ›´æ–°è§†å›¾]
    G --> H
    H --> I[åºåˆ—åŒ–è¾“å‡º]

    style A fill:#4ecdc4
    style B fill:#45b7d1
    style C fill:#96ceb4
    style D fill:#feca57
    style E fill:#ff9ff3
    style F fill:#54a0ff
    style G fill:#ff6b6b
    style H fill:#4ecdc4
    style I fill:#45b7d1
```

## ğŸ”§ æ•…éšœæ’é™¤

å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆï¼š

1. **å…‰æ ‡å®šä½å¼‚å¸¸**ï¼š

   - æ£€æŸ¥ slate çš„ isInline é…ç½®æ˜¯å¦æ­£ç¡®
   - ç¡®ä¿å˜é‡æ ‡ç­¾ç»„ä»¶çš„ DOM ç»“æ„æ­£ç¡®

2. **å†…å®¹åºåˆ—åŒ–ä¸å‡†ç¡®**ï¼š

   - æ£€æŸ¥ serializeToPlainText å‡½æ•°çš„å®ç°
   - ç¡®ä¿æ‰€æœ‰å…ƒç´ ç±»å‹éƒ½è¢«æ­£ç¡®å¤„ç†

3. **æ–¹æ³•è°ƒç”¨æ— æ•ˆ**ï¼š
   - ç¡®ä¿æ­£ç¡®ä¼ é€’ ref å¼•ç”¨
   - æ£€æŸ¥ç»„ä»¶æ˜¯å¦å·²æ­£ç¡®æŒ‚è½½
