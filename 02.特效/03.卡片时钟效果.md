---
title: 卡片时钟效果
date: 2025-09-25
permalink: /special-effects/card-clock
categories:
  - 特效
---

# 卡片时钟效果

## 简介

卡片时钟效果是一个使用 HTML、CSS 和 TypeScript 实现的数字时钟显示效果。通过 13 个片段的不同组合来显示数字 0-9，创造出独特的卡片式数字显示效果。该效果使用 CSS transition 实现平滑的动画过渡，为用户带来良好的视觉体验。

该组件支持丰富的自定义配置：

- 实时时间显示和自定义时间显示两种模式
- 可自定义片段大小（pieceSize），默认 10px
- 可自定义容器尺寸（containerWidth/containerHeight）
- 支持响应式设计，适配不同屏幕尺寸
- 使用 CSS 变量和 calc() 函数实现灵活的布局控制

## 效果演示

<demo react="react/effects/CardClock/example.tsx" 
:reactFiles="['react/effects/CardClock/example.tsx', 'react/effects/CardClock/index.tsx','react/effects/CardClock/index.scss']" />

## 核心技术要点

### 1. 片段设计

卡片时钟使用 13 个片段来组合成数字 0-9，布局与原版 HTML 代码完全一致：

```ssh
 1  2  3
 4     5
 6  7  8
 9    10
11 12 13
```

每个数字都有对应的片段显示状态：

```ts
const NUMBER_STATES: number[][] = [
	[1, 2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13], // 0
	[3, 5, 8, 10, 13], // 1
	[1, 2, 3, 5, 6, 7, 8, 9, 11, 12, 13], // 2
	[1, 2, 3, 5, 6, 7, 8, 10, 11, 12, 13], // 3
	[1, 3, 4, 5, 6, 7, 8, 10, 13], // 4
	[1, 2, 3, 4, 6, 7, 8, 10, 11, 12, 13], // 5
	[1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13], // 6
	[1, 2, 3, 5, 8, 10, 13], // 7
	[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], // 8
	[1, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13] // 9
];
```

### 2. CSS 样式实现

使用 CSS 变量和 calc() 函数实现响应式片段布局：

```scss
.card-clock {
	background-color: #212121;
	display: flex;
	align-items: center;
	justify-content: center;
	margin: 0;
	font-family: Arial, sans-serif;

	.container {
		display: flex;
		align-items: center;
		justify-content: center;
		transform: scale(0.8); // 适当缩放以适应容器
	}

	.flex {
		display: flex;
		align-items: center;
		justify-content: center;
		margin: 0 8px;
		border: 1px solid #fff;
		padding: 20px;
		border-radius: 10px;
	}

	.number {
		position: relative;
		height: calc(var(--piece-size) _ 5.8);
		width: calc(var(--piece-size) _ 3.4);
		margin: 20px;
		--piece-size: 10px;
	}

	.piece {
		background-color: #fff;
		border: 2px solid transparent;
		border-right-color: #aaa;
		border-bottom-color: #aaa;
		position: absolute;
		height: var(--piece-size);
		width: var(--piece-size);
		transform: scale(0);
		transition: transform 0.2s linear;

		&.show {
			transform: scale(1);
		}
	}

	// 13 个片段的位置，使用 calc()基于片段大小计算
	.piece:nth-of-type(1) {
		top: 0;
		left: 0;
	}
	.piece:nth-of-type(2) {
		top: 0;
		left: calc(var(--piece-size) _ 1.2);
	}
	.piece:nth-of-type(3) {
		top: 0;
		left: calc(var(--piece-size) _ 2.4);
	}
	.piece:nth-of-type(4) {
		top: calc(var(--piece-size) _ 1.2);
		left: 0;
	}
	.piece:nth-of-type(5) {
		top: calc(var(--piece-size) _ 1.2);
		left: calc(var(--piece-size) _ 2.4);
	}
	.piece:nth-of-type(6) {
		top: calc(var(--piece-size) _ 2.4);
		left: 0;
	}
	.piece:nth-of-type(7) {
		top: calc(var(--piece-size) _ 2.4);
		left: calc(var(--piece-size) _ 1.2);
	}
	.piece:nth-of-type(8) {
		top: calc(var(--piece-size) _ 2.4);
		left: calc(var(--piece-size) _ 2.4);
	}
	.piece:nth-of-type(9) {
		top: calc(var(--piece-size) _ 3.6);
		left: 0;
	}
	.piece:nth-of-type(10) {
		top: calc(var(--piece-size) _ 3.6);
		left: calc(var(--piece-size) _ 2.4);
	}
	.piece:nth-of-type(11) {
		top: calc(var(--piece-size) _ 4.8);
		left: 0;
	}
	.piece:nth-of-type(12) {
		top: calc(var(--piece-size) _ 4.8);
		left: calc(var(--piece-size) _ 1.2);
	}
	.piece:nth-of-type(13) {
		top: calc(var(--piece-size) _ 4.8);
		left: calc(var(--piece-size) _ 2.4);
	}
}
```

实现思路：

1. 使用 CSS 变量 `--piece-size` 作为基础尺寸单位，默认值为 10px
2. 通过 calc() 函数基于基础尺寸计算所有位置和尺寸，确保比例一致
3. 使用绝对定位将每个片段放置在正确的位置
4. 通过 transform: scale(0) 和 scale(1) 控制片段的显示和隐藏
5. 使用 CSS transition 实现 0.2 秒的平滑缩放动画
6. 通过 &.show 选择器控制片段显示状态
7. 使用相对定位的 .number 容器包含所有片段
8. 通过 transform: scale(0.8) 适当缩放整体以适应容器

### 3. 自定义尺寸控制

通过 props 控制片段大小和容器尺寸：

```tsx
interface CardClockProps {
	hour?: number;
	minute?: number;
	second?: number;
	className?: string;
	style?: React.CSSProperties;
	pieceSize?: number; // 片段大小，默认10px
	containerWidth?: number; // 容器宽度，默认570px
	containerHeight?: number; // 容器高度，默认400px
}

// 使用示例
<CardClock pieceSize={15} containerWidth={600} containerHeight={450} />;
```

实现思路：

1. 通过 pieceSize 属性控制基础片段大小，默认值为 10px
2. 使用 CSS 变量将 pieceSize 传递给样式系统：`{ '--piece-size': \`${pieceSize}px\` }`
3. 所有位置和尺寸都通过 calc() 函数基于 `--piece-size` 变量计算
4. 通过 containerWidth 和 containerHeight 属性控制整体容器尺寸
5. 使用 transform: scale() 适配不同尺寸的容器

## 实现原理

### 1. 数字显示原理

卡片时钟通过 13 个片段的不同组合来显示数字 0-9。每个片段都有固定的位置，通过添加或移除 `.show` 类来控制显示或隐藏。

实现思路：

1. 预定义每个数字对应的片段显示状态：通过 NUMBER_STATES 数组定义每个数字需要显示的片段索引
2. 通过 CSS 变量控制片段大小，实现响应式布局：使用 `--piece-size` CSS 变量作为基础单位
3. 使用 calc() 函数基于片段大小动态计算位置：所有位置都基于 `--piece-size` 变量计算
4. 通过 React 状态管理时间显示：使用 useState 和 useEffect 管理时间状态和更新

### 2. 动画实现

使用 CSS transition 实现平滑的显示/隐藏动画：

```scss
.piece {
	transform: scale(0);
	transition: transform 0.2s linear;
}

.piece.show {
	transform: scale(1);
}
```

实现思路：

1. 初始状态下所有片段都处于 scale(0) 状态，即不可见
2. 当片段需要显示时，添加 .show 类，使其 scale(1)，即正常大小显示
3. 通过 CSS transition 实现 0.2 秒的平滑缩放动画

### 3. 时间更新机制

使用 `setInterval` 每秒更新一次时间显示：

```ts
useEffect(() => {
	if (propHour === undefined && propMinute === undefined && propSecond === undefined) {
		const updateTime = () => {
			const now = new Date();
			setTime({
				hour: now.getHours(),
				minute: now.getMinutes(),
				second: now.getSeconds()
			});
		};

		updateTime();
		const interval = setInterval(updateTime, 1000);

		return () => clearInterval(interval);
	}
}, [propHour, propMinute, propSecond]);
```

实现思路：

1. 使用 useEffect 钩子在组件挂载时启动定时器
2. 通过判断 props 是否传入时间来决定是否使用实时时间
3. 每秒更新一次时间状态，触发组件重新渲染
4. 组件卸载时清除定时器，避免内存泄漏

### 4. 响应式设计实现思路

1. 使用 CSS 变量 `--piece-size` 控制基础尺寸单位：所有尺寸计算都基于这个变量
2. 通过 `calc()` 函数基于基础尺寸计算所有位置和尺寸：确保比例一致
3. 容器尺寸可通过 props 自定义：支持 containerWidth 和 containerHeight 属性
4. 使用 `transform: scale()` 适配不同容器尺寸：通过缩放整体适应容器

## React 组件实现

### 核心组件

```tsx
import React, { useState, useEffect } from 'react';
import './index.scss';

// 定义数字状态，每个数组表示对应数字需要显示的片段索引
const NUMBER_STATES: number[][] = [
[1, 2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13], // 0
[3, 5, 8, 10, 13], // 1
// ... 其他数字状态
];

interface NumberDisplayProps {
digit: number;
pieceSize?: number;
}

const NumberDisplay: React.FC<NumberDisplayProps> = ({ digit, pieceSize }) => {
const pieces = Array(13).fill(0);

return (
<div
className="number"
style={pieceSize ? ({ '--piece-size': `${pieceSize}px` } as React.CSSProperties) : {}} >
{pieces.map((\_, index) => {
const show = NUMBER_STATES[digit].includes(index + 1);
return <div key={index} className={`piece ${show ? 'show' : ''}`} />;
})}
</div>
);
};

interface CardClockProps {
hour?: number;
minute?: number;
second?: number;
className?: string;
style?: React.CSSProperties;
pieceSize?: number;
containerWidth?: number;
containerHeight?: number;
}

const CardClock: React.FC<CardClockProps> = ({
hour: propHour,
minute: propMinute,
second: propSecond,
className = '',
style = {},
pieceSize = 10,
containerWidth = 570,
containerHeight = 400
}) => {
const [time, setTime] = useState({
hour: propHour ?? 0,
minute: propMinute ?? 0,
second: propSecond ?? 0
});

useEffect(() => {
if (propHour === undefined && propMinute === undefined && propSecond === undefined) {
const updateTime = () => {
const now = new Date();
setTime({
hour: now.getHours(),
minute: now.getMinutes(),
second: now.getSeconds()
});
};

      updateTime();
      const interval = setInterval(updateTime, 1000);

      return () => clearInterval(interval);
    }

}, [propHour, propMinute, propSecond]);

const formatNumber = (num: number): string => {
return num < 10 ? `0${num}` : `${num}`;
};

const getDigits = (num: number): [number, number] => {
const str = formatNumber(num);
return [parseInt(str[0]), parseInt(str[1])];
};

const [hourTens, hourOnes] = getDigits(time.hour);
const [minuteTens, minuteOnes] = getDigits(time.minute);
const [secondTens, secondOnes] = getDigits(time.second);

return (
<div
className={`card-clock ${className}`}
style={{
        ...style,
        width: `${containerWidth}px`,
        height: `${containerHeight}px`
      }} >
<div className="container">
<div className="flex" id="hours">
<NumberDisplay digit={hourTens} pieceSize={pieceSize} />
<NumberDisplay digit={hourOnes} pieceSize={pieceSize} />
</div>

        <div className="flex" id="minutes">
          <NumberDisplay digit={minuteTens} pieceSize={pieceSize} />
          <NumberDisplay digit={minuteOnes} pieceSize={pieceSize} />
        </div>

        <div className="flex" id="seconds">
          <NumberDisplay digit={secondTens} pieceSize={pieceSize} />
          <NumberDisplay digit={secondOnes} pieceSize={pieceSize} />
        </div>
      </div>
    </div>

);
};

export default CardClock;

```

实现思路：

1. NumberDisplay 组件负责单个数字的显示，接收 digit 和 pieceSize 属性
2. 通过 NUMBER_STATES 数组确定每个数字需要显示的片段
3. 使用 Array(13).fill(0) 创建 13 个片段的数组
4. 通过 map 遍历数组，根据 NUMBER_STATES 状态决定是否添加 .show 类
5. CardClock 组件负责整体时钟的布局和时间管理
6. 使用 useState 管理时间状态，useEffect 处理时间更新
7. 通过 getDigits 函数将数字分解为十位和个位
8. 支持自定义时间显示和实时时间显示两种模式
9. 通过 props 控制整体样式和尺寸

## 使用说明

### 基本使用

```tsx
import CardClock from './effects/CardClock';

function App() {
	return (
		<div style={{ height: '100vh' }}>
			<CardClock />
		</div>
	);
}
```

### 自定义配置

```tsx
// 自定义时间显示
<CardClock hour={12} minute={30} second={45} />

// 自定义片段大小
<CardClock pieceSize={15} />

// 自定义容器尺寸
<CardClock containerWidth={600} containerHeight={450} />

// 组合使用
<CardClock
  hour={12}
  minute={30}
  second={45}
  pieceSize={12}
  containerWidth={600}
  containerHeight={450}
/>

```

## 优化建议

### 1. 性能优化

- 使用 `React.memo` 优化组件渲染
- 避免不必要的状态更新
- 合理使用 CSS 变量减少重排重绘

### 2. 可访问性

- 添加适当的 aria-label 属性
- 支持键盘导航
- 考虑颜色对比度

### 3. 主题定制

- 支持自定义颜色主题
- 支持不同的尺寸配置
- 提供明暗模式切换

## 浏览器兼容性

- Chrome 36+
- Firefox 16+
- Safari 9+
- Edge 12+
- IE 10+

## 结语

卡片时钟效果通过巧妙的片段组合和 CSS 动画，创造出独特的数字显示效果。该效果不仅展示了 CSS 和 JavaScript 的强大功能，也为网页增添了动态和趣味性。

核心实现亮点：

1. 使用 13 个片段的精巧布局实现数字 0-9 的显示
2. 通过 CSS 变量和 calc() 函数实现响应式设计
3. 利用 React 状态管理实现时间更新和组件渲染
4. 通过 CSS transition 实现平滑的动画效果
5. 支持丰富的自定义配置选项

通过合理的优化和自定义配置，可以将其应用于各种场景，如时钟应用、倒计时器、数字显示面板等。该组件具有良好的可扩展性和可维护性，可以根据具体需求进行进一步定制和优化。

```

```
