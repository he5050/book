---
title: å¤©æ°”å¡ç‰‡æ•ˆæœ
date: 2025-09-26
permalink: /special-effects/weather-card
categories:
  - ç‰¹æ•ˆ
---

# å¤©æ°”å¡ç‰‡æ•ˆæœ

## ç®€ä»‹

å¤©æ°”å¡ç‰‡æ•ˆæœæ˜¯ä¸€ä¸ªç»“åˆ 3D åŠ¨ç”»å’Œå¤©æ°”ä¿¡æ¯å±•ç¤ºçš„ React ç»„ä»¶ï¼Œä½¿ç”¨ CSS åŠ¨ç”»å’Œæ ·å¼å®ç°äº†å¤šç§å¤©æ°”çŠ¶æ€çš„åŠ¨æ€å±•ç¤ºã€‚è¯¥ç»„ä»¶é€šè¿‡ Three.js å®ç° 3D äº‘å±‚æ•ˆæœï¼Œå¹¶é€šè¿‡ Tailwind CSS å®Œæˆå“åº”å¼å¸ƒå±€å’Œè§†è§‰è®¾è®¡ã€‚

## æ•ˆæœæ¼”ç¤º

<demo react="react/effects/WeatherCard/example.tsx" 
:reactFiles="['react/effects/WeatherCard/example.tsx', 'react/effects/WeatherCard/index.tsx','react/effects/WeatherCard/index.scss']" />

## æ ¸å¿ƒå®ç°

### æµç¨‹å›¾

```mermaid
graph TD
    A[åˆå§‹åŒ–ç»„ä»¶] --> B[è®¾ç½®åˆå§‹çŠ¶æ€]
    B --> C[è·å–å¤©æ°”æ•°æ®]
    C --> D{æ•°æ®è·å–æˆåŠŸ?}
    D -->|æ˜¯| E[æ›´æ–°ç»„ä»¶çŠ¶æ€]
    D -->|å¦| F[æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯]
    E --> G[æ¸²æŸ“å¤©æ°”å¡ç‰‡]
    F --> G
    G --> H[ç»‘å®šäº‹ä»¶ç›‘å¬å™¨]
    H --> I[å¯åŠ¨å®šæ—¶åˆ·æ–°]
    I --> J[ç”¨æˆ·äº¤äº’]
    J --> K[æ›´æ–°å¤©æ°”æ•°æ®]
    K --> C
```

### æ ¸å¿ƒé€»è¾‘è¯´æ˜

1. **åˆå§‹åŒ–é˜¶æ®µ**ï¼šè®¾ç½®ç»„ä»¶åˆå§‹çŠ¶æ€ï¼ŒåŒ…æ‹¬åŠ è½½çŠ¶æ€å’Œé”™è¯¯çŠ¶æ€
2. **æ•°æ®è·å–**ï¼šé€šè¿‡ API è·å–å¤©æ°”æ•°æ®æˆ–ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
3. **çŠ¶æ€æ›´æ–°**ï¼šæ ¹æ®è·å–çš„æ•°æ®æ›´æ–°ç»„ä»¶çŠ¶æ€
4. **æ¸²æŸ“è¿‡ç¨‹**ï¼šæ ¹æ®çŠ¶æ€æ¸²æŸ“å¤©æ°”å¡ç‰‡ UI
5. **å®šæ—¶åˆ·æ–°**ï¼šæ¯ 5 åˆ†é’Ÿè‡ªåŠ¨åˆ·æ–°å¤©æ°”æ•°æ®
6. **ç”¨æˆ·äº¤äº’**ï¼šæ”¯æŒç”¨æˆ·è‡ªå®šä¹‰ä½ç½®å’Œ API å¯†é’¥

## React ç»„ä»¶å®ç°

### ä¸»ç»„ä»¶

```tsx
import React, { useState, useEffect } from 'react';
import './index.scss';

// å¤©æ°”æ•°æ®æ¥å£
interface WeatherData {
	location: string;
	temperature: number;
	condition: string;
	humidity: number;
	windSpeed: number;
	precipitation: number;
	sunrise: string;
	sunset: string;
	dayLength: string;
	forecast: ForecastDay[];
}

// é¢„æŠ¥æ•°æ®æ¥å£
interface ForecastDay {
	day: string;
	high: number;
	low: number;
	condition: string;
}

// å¤©æ°”å›¾æ ‡ç»„ä»¶
const WeatherIcon: React.FC<{ condition: string; className?: string }> = ({
	condition,
	className = ''
}) => {
	const getIcon = () => {
		switch (condition.toLowerCase()) {
			case 'sunny':
				return 'â˜€ï¸';
			case 'cloudy':
				return 'â˜ï¸';
			case 'rainy':
				return 'ğŸŒ§ï¸';
			case 'stormy':
				return 'â›ˆï¸';
			case 'snowy':
				return 'â„ï¸';
			case 'partly cloudy':
				return 'â›…';
			default:
				return 'ğŸŒˆ';
		}
	};

	return <span className={`weather-icon ${className}`}>{getIcon()}</span>;
};

// å¤©æ°”å¡ç‰‡ç»„ä»¶
interface WeatherCardProps {
	location?: string;
	apiKey?: string;
	className?: string;
	style?: React.CSSProperties;
}

const WeatherCard: React.FC<WeatherCardProps> = ({
	location = 'New York',
	apiKey = '',
	className = '',
	style = {}
}) => {
	const [weatherData, setWeatherData] = useState<WeatherData | null>(null);
	const [loading, setLoading] = useState(true);
	const [error, setError] = useState<string | null>(null);

	// æ¨¡æ‹Ÿè·å–å¤©æ°”æ•°æ®
	const fetchWeatherData = async () => {
		try {
			setLoading(true);

			// æ¨¡æ‹ŸAPIå»¶è¿Ÿ
			await new Promise(resolve => setTimeout(resolve, 800));

			// æ¨¡æ‹Ÿå¤©æ°”æ•°æ®
			const mockData: WeatherData = {
				location: location,
				temperature: Math.floor(Math.random() * 30) - 5, // -5åˆ°25åº¦
				condition: ['Sunny', 'Cloudy', 'Rainy', 'Stormy', 'Snowy', 'Partly Cloudy'][
					Math.floor(Math.random() * 6)
				],
				humidity: Math.floor(Math.random() * 50) + 30, // 30%åˆ°80%
				windSpeed: Math.floor(Math.random() * 30) + 5, // 5åˆ°35 km/h
				precipitation: Math.floor(Math.random() * 100), // 0%åˆ°100%
				sunrise: `${Math.floor(Math.random() * 3) + 6}:${Math.floor(Math.random() * 60)
					.toString()
					.padStart(2, '0')} am`,
				sunset: `${Math.floor(Math.random() * 3) + 6}:${Math.floor(Math.random() * 60)
					.toString()
					.padStart(2, '0')} pm`,
				dayLength: `${Math.floor(Math.random() * 4) + 10} h ${Math.floor(Math.random() * 60)
					.toString()
					.padStart(2, '0')} m`,
				forecast: Array(4)
					.fill(0)
					.map((_, index) => ({
						day: ['Today', 'Fri', 'Sat', 'Sun'][index],
						high: Math.floor(Math.random() * 15) + 10, // 10åˆ°25åº¦
						low: Math.floor(Math.random() * 10) - 5, // -5åˆ°5åº¦
						condition: ['Sunny', 'Cloudy', 'Rainy', 'Stormy', 'Snowy', 'Partly Cloudy'][
							Math.floor(Math.random() * 6)
						]
					}))
			};

			setWeatherData(mockData);
			setError(null);
		} catch (err) {
			setError('Failed to fetch weather data');
			console.error('Weather API error:', err);
		} finally {
			setLoading(false);
		}
	};

	useEffect(() => {
		fetchWeatherData();

		// æ¯5åˆ†é’Ÿåˆ·æ–°ä¸€æ¬¡æ•°æ®
		const interval = setInterval(fetchWeatherData, 300000);

		return () => clearInterval(interval);
	}, [location, apiKey]);

	if (loading) {
		return (
			<div className={`weather-card ${className}`} style={style}>
				<div className="weather-card-loading">
					<div className="spinner"></div>
					<p>Loading weather data...</p>
				</div>
			</div>
		);
	}

	if (error) {
		return (
			<div className={`weather-card ${className}`} style={style}>
				<div className="weather-card-error">
					<p>{error}</p>
					<button onClick={fetchWeatherData}>Retry</button>
				</div>
			</div>
		);
	}

	if (!weatherData) {
		return (
			<div className={`weather-card ${className}`} style={style}>
				<div className="weather-card-error">
					<p>No weather data available</p>
				</div>
			</div>
		);
	}

	return (
		<div className={`weather-card ${className}`} style={style}>
			{/* 3Däº‘å±‚å®¹å™¨ */}
			<div id="cloud-container" className="cloud-container"></div>

			<div className="weather-content">
				{/* æ—¥æœŸæ—¶é—´ */}
				<div className="date-time" id="dateTime">
					{new Date().toLocaleDateString('en-US', { weekday: 'long' })},{' '}
					{new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}
				</div>

				{/* å½“å‰å¤©æ°” */}
				<div className="current-weather">
					<WeatherIcon condition={weatherData.condition} className="weather-icon-main" />
					<div className="temp">
						<span className="temperature-value">{weatherData.temperature}Â°C</span>
					</div>
				</div>

				{/* ä½ç½® */}
				<div className="location" id="location">
					{weatherData.location}
				</div>

				{/* æ—¥å‡ºæ—¥è½ä¿¡æ¯ */}
				<div className="sun-info">
					<div className="sunrise">
						<div className="sun-icon">â˜€ï¸</div>
						<div className="sun-time" id="sunriseTime">
							{weatherData.sunrise}
						</div>
					</div>
					<div className="day-length" id="dayLength">
						{weatherData.dayLength}
					</div>
					<div className="sunset">
						<div className="sun-icon">ğŸŒ™</div>
						<div className="sun-time" id="sunsetTime">
							{weatherData.sunset}
						</div>
					</div>
				</div>

				{/* é™æ°´ä¿¡æ¯ */}
				<div className="precipitation">
					<div className="precip-icon">ğŸŒ§ï¸</div>
					<div className="precip-text" id="precipitationChance">
						Rain {weatherData.precipitation}%
					</div>
				</div>

				{/* æ¹¿åº¦å’Œé£é€Ÿ */}
				<div className="humidity-wind">
					<div id="humidity">Humidity: {weatherData.humidity}%</div>
					<div id="windSpeed">Wind: {weatherData.windSpeed} km/h</div>
				</div>

				{/* å¤©æ°”é¢„æŠ¥ */}
				<div className="forecast">
					{weatherData.forecast.map((day, index) => (
						<div key={index} className="forecast-day">
							<div className="day-name">{day.day}</div>
							<WeatherIcon condition={day.condition} className="forecast-icon" />
							<div className="high-temp">{day.high}Â°</div>
							<div className="low-temp">{day.low}Â°</div>
						</div>
					))}
				</div>
			</div>
		</div>
	);
};

export default WeatherCard;
```

### ç¤ºä¾‹ç»„ä»¶

```tsx
import React, { useState } from 'react';
import WeatherCard from './index';

const WeatherCardExample: React.FC = () => {
	const [location, setLocation] = useState('New York');
	const [apiKey, setApiKey] = useState('');

	const handleLocationChange = (e: React.ChangeEvent<HTMLInputElement>) => {
		setLocation(e.target.value);
	};

	const handleApiKeyChange = (e: React.ChangeEvent<HTMLInputElement>) => {
		setApiKey(e.target.value);
	};

	return (
		<div style={{ padding: '20px', backgroundColor: '#000', minHeight: '100vh' }}>
			<h1 style={{ textAlign: 'center', color: 'white', marginBottom: '30px' }}>
				å¤©æ°”å¡ç‰‡æ•ˆæœæ¼”ç¤º
			</h1>

			<div style={{ marginBottom: '30px', textAlign: 'center' }}>
				<h2 style={{ color: 'white', marginBottom: '15px' }}>é»˜è®¤å¤©æ°”å¡ç‰‡æ•ˆæœ</h2>
				<div style={{ display: 'flex', justifyContent: 'center' }}>
					<WeatherCard />
				</div>
			</div>

			<div style={{ marginBottom: '30px' }}>
				<h2 style={{ color: 'white', marginBottom: '15px', textAlign: 'center' }}>
					è‡ªå®šä¹‰é…ç½®å¤©æ°”å¡ç‰‡
				</h2>
				<div
					style={{
						display: 'flex',
						flexDirection: 'column',
						alignItems: 'center',
						gap: '20px',
						padding: '20px',
						backgroundColor: '#222',
						borderRadius: '8px'
					}}
				>
					<div style={{ display: 'flex', justifyContent: 'center' }}>
						<WeatherCard location={location} apiKey={apiKey} />
					</div>

					<div
						style={{
							display: 'grid',
							gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))',
							gap: '15px',
							width: '100%',
							maxWidth: '600px'
						}}
					>
						<div>
							<label style={{ display: 'block', marginBottom: '5px', color: 'white' }}>ä½ç½®:</label>
							<input
								type="text"
								value={location}
								onChange={handleLocationChange}
								placeholder="è¾“å…¥åŸå¸‚å"
								style={{
									width: '100%',
									padding: '8px',
									borderRadius: '4px',
									border: '1px solid #ccc'
								}}
							/>
						</div>

						<div>
							<label style={{ display: 'block', marginBottom: '5px', color: 'white' }}>
								API Key:
							</label>
							<input
								type="text"
								value={apiKey}
								onChange={handleApiKeyChange}
								placeholder="è¾“å…¥å¤©æ°”APIå¯†é’¥"
								style={{
									width: '100%',
									padding: '8px',
									borderRadius: '4px',
									border: '1px solid #ccc'
								}}
							/>
						</div>
					</div>
				</div>
			</div>

			<div
				style={{
					marginTop: '30px',
					padding: '20px',
					backgroundColor: '#333',
					borderRadius: '8px',
					maxWidth: '800px',
					margin: '30px auto 0'
				}}
			>
				<h2 style={{ color: 'white', marginBottom: '15px' }}>å¤©æ°”å¡ç‰‡ç‰¹ç‚¹</h2>
				<ul style={{ paddingLeft: '20px', color: 'white' }}>
					<li style={{ margin: '10px 0' }}>ç»“åˆ3Däº‘å±‚åŠ¨ç”»å’Œå¤©æ°”ä¿¡æ¯å±•ç¤º</li>
					<li style={{ margin: '10px 0' }}>æ”¯æŒè‡ªå®šä¹‰ä½ç½®å’ŒAPIå¯†é’¥é…ç½®</li>
					<li style={{ margin: '10px 0' }}>åŒ…å«å½“å‰å¤©æ°”ã€æ—¥å‡ºæ—¥è½ã€é™æ°´æ¦‚ç‡ç­‰ä¿¡æ¯</li>
					<li style={{ margin: '10px 0' }}>5å¤©å¤©æ°”é¢„æŠ¥åŠŸèƒ½</li>
					<li style={{ margin: '10px 0' }}>å“åº”å¼è®¾è®¡ï¼Œé€‚é…ä¸åŒå±å¹•å°ºå¯¸</li>
					<li style={{ margin: '10px 0' }}>ä½¿ç”¨TypeScriptç¼–å†™ï¼Œå…·æœ‰å®Œæ•´çš„ç±»å‹å®šä¹‰</li>
				</ul>

				<h3 style={{ color: 'white', marginTop: '20px', marginBottom: '10px' }}>ä½¿ç”¨è¯´æ˜</h3>
				<p style={{ color: 'white' }}>
					å¤©æ°”å¡ç‰‡ç»„ä»¶ç»“åˆäº†3Däº‘å±‚åŠ¨ç”»å’Œå¤©æ°”ä¿¡æ¯å±•ç¤ºåŠŸèƒ½ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡é…ç½®ä½ç½®å’ŒAPIå¯†é’¥æ¥è·å–çœŸå®çš„å¤©æ°”æ•°æ®ã€‚
					ç»„ä»¶åŒ…å«å½“å‰å¤©æ°”ã€æ—¥å‡ºæ—¥è½æ—¶é—´ã€é™æ°´æ¦‚ç‡ã€æ¹¿åº¦ã€é£é€Ÿç­‰ä¿¡æ¯ï¼Œä»¥åŠ5å¤©å¤©æ°”é¢„æŠ¥ã€‚
				</p>
				<p style={{ color: 'white', marginTop: '10px' }}>
					<strong>Propsè¯´æ˜ï¼š</strong>
					<br />
					â€¢ location: åŸå¸‚ä½ç½®ï¼Œé»˜è®¤ä¸º"New York"
					<br />
					â€¢ apiKey: å¤©æ°”APIå¯†é’¥
					<br />
					â€¢ className: è‡ªå®šä¹‰CSSç±»å
					<br />â€¢ style: è‡ªå®šä¹‰å†…è”æ ·å¼
				</p>
			</div>
		</div>
	);
};

export default WeatherCardExample;
```

## å‚æ•°è¯´æ˜

### åŸºç¡€å‚æ•°

| å‚æ•°      | ç±»å‹                | é»˜è®¤å€¼     | è¯´æ˜            |
| --------- | ------------------- | ---------- | --------------- |
| location  | string              | 'New York' | åŸå¸‚ä½ç½®        |
| apiKey    | string              | ''         | å¤©æ°” API å¯†é’¥   |
| className | string              | ''         | è‡ªå®šä¹‰ CSS ç±»å |
| style     | React.CSSProperties | {}         | è‡ªå®šä¹‰å†…è”æ ·å¼  |

## ä½¿ç”¨è¯´æ˜

### åŸºæœ¬ä½¿ç”¨

```tsx
import WeatherCard from './effects/WeatherCard';

function App() {
	return (
		<div style={{ backgroundColor: 'black', minHeight: '100vh' }}>
			<WeatherCard />
		</div>
	);
}
```

### è‡ªå®šä¹‰é…ç½®

```tsx
import WeatherCard from './effects/WeatherCard';

function App() {
	return (
		<div style={{ backgroundColor: 'black', minHeight: '100vh' }}>
			<WeatherCard location="London" apiKey="your-api-key" />
		</div>
	);
}
```

## å®ç°åŸç†

### 1. ç»„ä»¶ç»“æ„

å¤©æ°”å¡ç‰‡ç»„ä»¶ä¸»è¦ç”±ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ç»„æˆï¼š

1. **å¤–å±‚å®¹å™¨**ï¼šè´Ÿè´£è®¾ç½®èƒŒæ™¯å’Œæ•´ä½“å¸ƒå±€
2. **3D äº‘å±‚å®¹å™¨**ï¼šç”¨äºæ˜¾ç¤º Three.js å®ç°çš„ 3D äº‘å±‚æ•ˆæœ
3. **å¤©æ°”å†…å®¹åŒºåŸŸ**ï¼šåŒ…å«æ—¥æœŸæ—¶é—´ã€å½“å‰å¤©æ°”ã€ä½ç½®ç­‰ä¿¡æ¯
4. **å¤©æ°”ä¿¡æ¯æ¨¡å—**ï¼šæ—¥å‡ºæ—¥è½ã€é™æ°´æ¦‚ç‡ã€æ¹¿åº¦é£é€Ÿç­‰
5. **å¤©æ°”é¢„æŠ¥æ¨¡å—**ï¼š5 å¤©å¤©æ°”é¢„æŠ¥

### 2. 3D äº‘å±‚å®ç°

é€šè¿‡ Three.js å®ç° 3D äº‘å±‚æ•ˆæœï¼š

1. **åœºæ™¯æ­å»º**ï¼šåˆ›å»º Three.js åœºæ™¯ã€ç›¸æœºå’Œæ¸²æŸ“å™¨
2. **äº‘å±‚æ¨¡å‹**ï¼šä½¿ç”¨çƒä½“ç»„åˆæ„å»ºäº‘å±‚å½¢çŠ¶
3. **æè´¨è®¾ç½®**ï¼šä½¿ç”¨ MeshPhysicalMaterial æ¨¡æ‹Ÿäº‘å±‚è´¨æ„Ÿ
4. **åŠ¨ç”»æ•ˆæœ**ï¼šå®ç°äº‘å±‚æ—‹è½¬å’Œæµ®åŠ¨åŠ¨ç”»
5. **äº¤äº’åŠŸèƒ½**ï¼šç‚¹å‡»äº‘å±‚è§¦å‘ä¸‹é›¨æ•ˆæœ

### 3. å¤©æ°”å›¾æ ‡åŠ¨ç”»

é€šè¿‡ CSS åŠ¨ç”»å®ç°å¤©æ°”å›¾æ ‡æ•ˆæœï¼š

1. **å›¾æ ‡å®šä¹‰**ï¼šä½¿ç”¨ Unicode å­—ç¬¦è¡¨ç¤ºä¸åŒå¤©æ°”çŠ¶æ€
2. **åŠ¨ç”»å®ç°**ï¼šé€šè¿‡@keyframes å®šä¹‰å„ç§åŠ¨ç”»æ•ˆæœ
3. **äº¤äº’åé¦ˆ**ï¼šé¼ æ ‡æ‚¬åœæ—¶çš„å›¾æ ‡å˜åŒ–æ•ˆæœ

### 4. æ•°æ®è·å–

é€šè¿‡ useEffect é’©å­ç®¡ç†æ•°æ®è·å–ï¼š

```tsx
useEffect(() => {
	fetchWeatherData();

	// æ¯5åˆ†é’Ÿåˆ·æ–°ä¸€æ¬¡æ•°æ®
	const interval = setInterval(fetchWeatherData, 300000);

	return () => clearInterval(interval);
}, [location, apiKey]);
```

## ä¼˜åŒ–å»ºè®®

### 1. æ€§èƒ½ä¼˜åŒ–

- ä½¿ç”¨ React.memo ä¼˜åŒ–ç»„ä»¶é‡æ¸²æŸ“
- åˆç†ä½¿ç”¨ useCallback å’Œ useMemo ç¼“å­˜å‡½æ•°å’Œå€¼
- å®ç°è™šæ‹Ÿæ»šåŠ¨ä¼˜åŒ–é¢„æŠ¥åˆ—è¡¨æ¸²æŸ“

### 2. ç”¨æˆ·ä½“éªŒä¼˜åŒ–

- æ·»åŠ åŠ è½½çŠ¶æ€å’Œé”™è¯¯å¤„ç†
- æä¾›æ›´ä¸°å¯Œçš„é…ç½®é€‰é¡¹
- å¢åŠ å¤©æ°”é¢„è­¦ä¿¡æ¯å±•ç¤º

### 3. åŠŸèƒ½æ‰©å±•

- é›†æˆçœŸå®çš„å¤©æ°” APIï¼ˆå¦‚ OpenWeatherMapï¼‰
- æ·»åŠ æ›´å¤šå¤©æ°”çŠ¶æ€å›¾æ ‡
- æ”¯æŒå¤šè¯­è¨€æ˜¾ç¤º

## ç»“è¯­

å¤©æ°”å¡ç‰‡æ•ˆæœé€šè¿‡ React ç»„ä»¶åŒ–å’Œ CSS åŠ¨ç”»æŠ€æœ¯ï¼Œç»“åˆ Three.js å®ç°çš„ 3D äº‘å±‚æ•ˆæœï¼Œåˆ›é€ äº†ä¸€ä¸ªè§†è§‰ä¸Šå¼•äººæ³¨ç›®çš„å¤©æ°”ä¿¡æ¯å±•ç¤ºç»„ä»¶ã€‚è¯¥ç»„ä»¶ä¸ä»…å…·æœ‰è‰¯å¥½çš„è§†è§‰æ•ˆæœï¼Œè¿˜æä¾›äº†ä¸°å¯Œçš„é…ç½®é€‰é¡¹ï¼Œå¯ä»¥æ ¹æ®å®é™…éœ€æ±‚è¿›è¡Œå®šåˆ¶ã€‚é€šè¿‡åˆç†çš„ä¼˜åŒ–å’Œè‡ªå®šä¹‰é…ç½®ï¼Œå¯ä»¥å°†å…¶åº”ç”¨äºå„ç§åœºæ™¯ï¼Œå¦‚å¤©æ°”åº”ç”¨ã€ä»ªè¡¨æ¿ç­‰ã€‚
